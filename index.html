<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>AhnLab Knowledge Demo</title>

  <!-- 파비콘 (404 방지: 인라인 SVG) -->
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64'%3E%3Crect width='64' height='64' rx='12' fill='%23214e95'/%3E%3Ctext x='50%25' y='54%25' text-anchor='middle' font-size='34' fill='white' font-family='Arial'%3EAK%3C/text%3E%3C/svg%3E"/>

  <!-- 라이트(화이트+네이비) 테마 -->
  <link rel="stylesheet" href="./assets/styles.css" />

  <!-- 웹폰트 -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

  <!-- ✅ CSP: 필요한 Firebase만 허용 / 인라인 스크립트 금지 -->
  <meta http-equiv="Content-Security-Policy"
        content="
          default-src 'self';
          style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
          font-src https://fonts.gstatic.com 'self' data:;
          img-src 'self' data: https://firebasestorage.googleapis.com;
          script-src 'self' https://www.gstatic.com https://www.googleapis.com;
          connect-src 'self'
                      https://firestore.googleapis.com
                      https://www.googleapis.com
                      https://www.gstatic.com
                      https://securetoken.googleapis.com
                      https://identitytoolkit.googleapis.com
                      https://firebaseinstallations.googleapis.com;
          object-src 'none';
          base-uri 'self';
        ">
</head>
<body>
  <div id="app">
    <!-- 좌측 사이드바 -->
    <aside class="sidebar">
      <div class="brand">
        <div class="logo">AKS</div>
        <div class="brand-title">AhnLab Knowledge</div>
      </div>

      <nav class="nav">
        <a class="nav-item" data-route="#home"><span class="icon">🏠</span><span>학습하기</span></a>
        <a class="nav-item" data-route="#learning"><span class="icon">📚</span><span>러닝</span></a>
        <a class="nav-item" data-route="#anacademy"><span class="icon">📝</span><span>안카데미</span></a>
        <a class="nav-item" data-route="#notices"><span class="icon">📢</span><span>공지사항</span></a>
        <a class="nav-item" data-route="#idp"><span class="icon">🎯</span><span>IDP · 내 학습</span></a>
      </nav>

      <footer class="sidebar-footer">
        <button id="openComposer" class="btn btn-primary full">새 글 작성</button>
      </footer>
    </aside>

    <!-- 메인 -->
    <main class="main">
      <!-- 상단 헤더 -->
      <header class="header">
        <div class="search-wrap">
          <input id="globalSearch" class="input input-lg" type="search" placeholder="검색: 학습하기·러닝·안카데미·공지·IDP (예: Vue, 보안, Nest, HRD)" />
          <button id="searchBtn" class="btn btn-primary">검색</button>
        </div>
        <div class="demo-badge" title="데모 모드">DEMO</div>
      </header>

      <!-- 컨텐츠 -->
      <section id="viewContainer" class="content"></section>
    </main>
  </div>

  <!-- 모달: 글 작성 -->
  <dialog id="composerModal" class="modal">
    <form method="dialog" class="modal-card" id="composerForm">
      <h3 class="modal-title">새 글 작성</h3>
      <label class="field">
        <span>제목</span>
        <input type="text" id="postTitle" class="input" placeholder="제목을 입력하세요" maxlength="100" required>
      </label>
      <label class="field">
        <span>본문</span>
        <textarea id="postBody" class="textarea" placeholder="자유롭게 공유해요 (텍스트 기반)" rows="6" maxlength="3000" required></textarea>
      </label>
      <div class="row">
        <label class="field flex-1">
          <span>태그(쉼표로 구분)</span>
          <input type="text" id="postTags" class="input" placeholder="ex) vue, nest, hr, security">
        </label>
        <label class="field toggle-field">
          <input id="postToLearning" type="checkbox" />
          <span>러닝 항목으로도 등록</span>
        </label>
      </div>

      <div class="modal-actions">
        <button class="btn" value="cancel">취소</button>
        <button id="submitPostBtn" class="btn btn-primary" value="default">게시</button>
      </div>
    </form>
  </dialog>

  <!-- Toast -->
  <div id="toast" class="toast"></div>

  <!-- 외부 스크립트(인라인 금지) -->
  <script type="module" src="./assets/firebase.js"></script>
  <script type="module" src="./assets/data.js"></script>
  <script type="module" src="./assets/views.js"></script>
  <script type="module" src="./assets/boot.js"></script>
</body>
</html>
